// =======================================================================
//   Department of Electrical and Computer Engineering
//   Portland State University
//
//   Course name:  ECE 510 - Pre-Silicon Validation
//   Term & Year:  Spring 2015
//   Instructor :  Tareque Ahmad
//
//   Project:      Hardware implementation of PDP8 
//                 Instruction Set Architecture (ISA) level simulator
//
//   Filename:     exe_initiator.sv
//   Description:  Inititor For execute unit
//   Created by:   Nilesh Dattani
//   Date:         June 06, 2015
//
//   Copyright:    Tareque Ahmad
// =======================================================================


`include "pdp8_pkg.sv"
import pdp8_pkg::*;


parameter TRUE = 1'b1;
parameter FALSE = 1'b0;
bit debug;

module exe_initiator( 	input wire clk,
						input wire reset_n,
						output logic [`ADDR_WIDTH-1:0]base_addr,
						output pdp_mem_opcode_s pdp_mem_opcode,
						output pdp_op7_opcode_s pdp_op7_opcode,
						input stall,
						input [`ADDR_WIDTH-1:0]PC_value);
						
assign base_addr = `START_ADDRESS;
pdp_op7_opcode_s op7;
pdp_mem_opcode_s mem_opcode;

class stimulus;
	int opcode_number;	
task memcase;
input integer instruction;
mem_opcode = 0;
unique case(instruction)
	`AND : mem_opcode.AND = TRUE;
	`TAD : mem_opcode.TAD = TRUE;
	`ISZ : mem_opcode.ISZ = TRUE;
	`DCA : mem_opcode.DCA = TRUE;
	`JMS : mem_opcode.JMS = TRUE;
	`JMP : mem_opcode.JMP = TRUE;
endcase	
endtask

task op7case;
input [11:0] instruction;
op7 = 0;
unique case(instruction)
	
	`NOP     : op7.NOP	   = TRUE; 
	`IAC     : op7.IAC     = TRUE;
	`RAL     : op7.RAL     = TRUE;
	`RTL     : op7.RTL     = TRUE;
	`RAR     : op7.RAR     = TRUE;
	`RTR     : op7.RTR     = TRUE;
	`CML     : op7.CML     = TRUE;
	`CMA     : op7.CMA     = TRUE;
	`CIA     : op7.CIA     = TRUE;
	`CLL     : op7.CLL     = TRUE;
	`CLA1    : op7.CLA1    = TRUE;
	`CLA_CLL : op7.CLA_CLL = TRUE;
	`HLT     : op7.HLT     = TRUE;
	`OSR     : op7.OSR     = TRUE;
	`SKP     : op7.SKP     = TRUE;
	`SNL     : op7.SNL     = TRUE;
	`SZL     : op7.SZL     = TRUE;
	`SZA     : op7.SZA     = TRUE;
	`SNA     : op7.SNA     = TRUE;
	`SMA     : op7.SMA     = TRUE;
    `SPA     : op7.SPA     = TRUE;
    `CLA2    : op7.CLA2    = TRUE;
endcase
endtask
	
endclass

class stimulus_randomized;
endclass



initial begin
mem_opcode = 0;
op7=0;
@(negedge stall);
mem_opcode.AND = TRUE;
@(negedge stall);
mem_opcode = 0;
op7.NOP = TRUE;
@(negedge stall);
op7=0;
op7.CLA = TRUE;
end



						
endmodule